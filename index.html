<!doctype html>
<html lang="el">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Î‘ÏƒÏ„ÏÎ¿Î»Î¿Î³Î¯Î± Pro â€“ Î“ÎµÎ½Î­Î¸Î»Î¹Î¿Ï‚, Î£Ï…Î½Î±ÏƒÏ„ÏÎ¯Î± & SVG Î§Î¬ÏÏ„Î·Ï‚</title>

  <script src="https://cdn.jsdelivr.net/npm/astronomy-engine@2.1.19/astronomy.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    :root {
      --bg: #05070a;
      --card: rgba(13, 17, 23, 0.8);
      --accent: #6366f1;
      --accent-glow: rgba(99, 102, 241, 0.3);
      --text: #f1f5f9;
      --muted: #94a3b8;
      --good: #10b981;
      --bad: #ef4444;
      --warn: #f59e0b;
      --glass: rgba(255, 255, 255, 0.03);
    }

    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: var(--bg);
      background-image:
        radial-gradient(circle at 15% 15%, rgba(99, 102, 241, 0.1) 0%, transparent 40%),
        radial-gradient(circle at 85% 85%, rgba(139, 92, 246, 0.1) 0%, transparent 40%);
      color: var(--text);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      line-height: 1.6;
    }

    header {
      padding: 40px 20px;
      text-align: center;
      background: linear-gradient(to bottom, rgba(99, 102, 241, 0.05), transparent);
    }

    header h1 {
      margin: 0;
      font-weight: 800;
      font-size: 2.8rem;
      letter-spacing: -1.5px;
      background: linear-gradient(135deg, #fff 30%, var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    main {
      max-width: 1400px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 380px 1fr;
      gap: 30px;
      padding: 0 30px 50px;
    }

    .glass-card {
      background: var(--card);
      -webkit-backdrop-filter: blur(20px);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 24px;
      padding: 30px;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    }

    .form-group {
      margin-bottom: 24px;
    }

    label {
      display: block;
      font-size: 11px;
      font-weight: 700;
      color: var(--muted);
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 1.5px;
    }

    input,
    select {
      width: 100%;
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 14px 18px;
      color: #fff;
      border-radius: 14px;
      font-size: 15px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    input:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(99, 102, 241, 0.08);
      box-shadow: 0 0 20px var(--accent-glow);
    }

    .btn-row {
      display: flex;
      gap: 12px;
      margin-top: 10px;
    }

    button {
      flex: 1;
      padding: 16px;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      font-weight: 700;
      font-size: 14px;
      transition: all 0.3s;
      background: var(--glass);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    button:hover {
      transform: translateY(-3px);
      background: rgba(255, 255, 255, 0.08);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }

    button.primary {
      background: linear-gradient(135deg, var(--accent), #8b5cf6);
      box-shadow: 0 8px 25px var(--accent-glow);
      border: none;
    }

    button.primary:hover {
      box-shadow: 0 12px 30px var(--accent-glow);
      filter: brightness(1.15);
    }

    .tabs-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 30px;
      padding: 6px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 18px;
    }

    .tab {
      padding: 12px 20px;
      cursor: pointer;
      border-radius: 12px;
      font-size: 13px;
      transition: all 0.3s;
      color: var(--muted);
      font-weight: 600;
      border: 1px solid transparent;
    }

    .tab:hover:not(.active) {
      color: #fff;
      background: rgba(255, 255, 255, 0.05);
    }

    .tab.active {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 4px 12px var(--accent-glow);
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
      animation: slideUp 0.5s cubic-bezier(0.2, 1, 0.3, 1);
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 8px;
      margin-top: 10px;
    }

    th {
      text-align: left;
      padding: 12px 20px;
      color: var(--muted);
      font-weight: 700;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    td {
      padding: 18px 20px;
      background: rgba(255, 255, 255, 0.02);
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 14px;
    }

    td:first-child {
      border-radius: 15px 0 0 15px;
      border-left: 1px solid rgba(255, 255, 255, 0.05);
    }

    td:last-child {
      border-radius: 0 15px 15px 0;
      border-right: 1px solid rgba(255, 255, 255, 0.05);
    }

    .badge {
      padding: 6px 12px;
      border-radius: 10px;
      font-size: 10px;
      font-weight: 800;
      letter-spacing: 0.5px;
    }

    .badge.good {
      background: rgba(16, 185, 129, 0.1);
      color: #10b981;
      border: 1px solid rgba(16, 185, 129, 0.2);
    }

    .badge.bad {
      background: rgba(239, 68, 68, 0.1);
      color: #ef4444;
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .search-btn {
      background: var(--accent);
      width: 48px;
      height: 48px;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex: none;
    }

    #bio-bars h3 {
      margin-bottom: 20px;
      font-size: 1.4rem;
      color: #fff;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
      display: flex;
      opacity: 1;
    }

    .modal-content {
      background: var(--card);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 24px;
      padding: 40px;
      max-width: 600px;
      width: 90%;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.8);
      transform: translateY(20px);
      transition: transform 0.3s ease;
    }

    .modal-overlay.active .modal-content {
      transform: translateY(0);
    }

    .modal-content h2 {
      margin-top: 0;
      background: linear-gradient(135deg, #fff, var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .modal-content ol {
      padding-left: 20px;
    }

    .modal-content li {
      margin-bottom: 15px;
      color: var(--text);
    }

    .modal-content b {
      color: var(--accent);
    }

    .modal-close {
      margin-top: 25px;
      width: 100%;
    }

    @media (max-width: 1024px) {
      main {
        grid-template-columns: 1fr;
        padding: 20px;
      }

      header h1 {
        font-size: 2.2rem;
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>GR Astrology Pro</h1>
    <p style="color:var(--muted); margin-top:10px;">Î¨Ï…Ï‡Î¿ÏƒÏ‰Î¼Î±Ï„Î¹ÎºÎ® Î‘Î½Î¬Î»Ï…ÏƒÎ· & Î£Ï…Î¼Î²Î±Ï„ÏŒÏ„Î·Ï„Î±</p>
  </header>

  <main>
    <aside class="glass-card">
      <div class="tabs-container" style="background: none; padding: 0;">
        <div class="tab active" data-sec="sidebar-natal" style="flex:1; text-align:center;">Î“ÎµÎ½Î­Î¸Î»Î¹Î¿Ï‚</div>
        <div class="tab" data-sec="sidebar-synastry" style="flex:1; text-align:center;">Î£Ï…Î½Î±ÏƒÏ„ÏÎ¯Î±</div>
      </div>

      <div id="sidebar-natal" class="section active">
        <h3 style="margin-top:0;">Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î‘Ï„ÏŒÎ¼Î¿Ï…</h3>
        <div class="form-group">
          <label>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± (DD/MM/YYYY)</label>
          <input type="text" id="d1" placeholder="Ï€.Ï‡. 02/09/1967" value="02/09/1967"
            title="Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÏƒÎµ Î¼Î¿ÏÏ†Î® Î—Î—/ÎœÎœ/Î•Î•Î•Î•">
        </div>
        <div class="form-group">
          <label>ÎÏÎ± (24h Style - HH:MM)</label>
          <input type="text" id="t1" placeholder="Ï€.Ï‡. 05:15" value="05:15" title="Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÏÏÎ± ÏƒÎµ Î¼Î¿ÏÏ†Î® Î©Î©:Î›Î›">
        </div>
        <div class="form-group">
          <label>Î ÏŒÎ»Î· / Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±</label>
          <div style="display:flex; gap:8px;">
            <input type="text" id="city1" placeholder="Î‘Î˜Î—ÎÎ‘" value="MELBOURNE" title="Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï€ÏŒÎ»Î·">
            <button class="search-btn" onclick="geo('city1','lat1','lon1','elev1')"
              title="Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½Ï‰Î½">ğŸ”</button>
          </div>
        </div>
        <div style="display:flex; gap:10px; font-size:12px; margin-bottom:15px;">
          <div style="flex:1;"><label>Lat</label><input type="text" id="lat1" value="-37.8142"
              title="Î“ÎµÏ‰Î³ÏÎ±Ï†Î¹ÎºÏŒ Ï€Î»Î¬Ï„Î¿Ï‚"></div>
          <div style="flex:1;"><label>Lon</label><input type="text" id="lon1" value="144.9632" title="Î“ÎµÏ‰Î³ÏÎ±Ï†Î¹ÎºÏŒ Î¼Î®ÎºÎ¿Ï‚">
          </div>
        </div>
      </div>

      <div id="sidebar-synastry" class="section">
        <h3 style="margin-top:0;">Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± 2Î¿Ï… Î‘Ï„ÏŒÎ¼Î¿Ï…</h3>
        <div class="form-group">
          <label>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± (DD/MM/YYYY)</label>
          <input type="text" id="d2" placeholder="DD/MM/YYYY" title="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± 2Î¿Ï… Î±Ï„ÏŒÎ¼Î¿Ï…">
        </div>
        <div class="form-group">
          <label>ÎÏÎ± (HH:MM)</label>
          <input type="text" id="t2" placeholder="HH:MM" title="ÎÏÎ± 2Î¿Ï… Î±Ï„ÏŒÎ¼Î¿Ï…">
        </div>
        <div class="form-group">
          <label>Î ÏŒÎ»Î· / Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±</label>
          <div style="display:flex; gap:8px;">
            <input type="text" id="city2" placeholder="Î ÏŒÎ»Î·" title="Î ÏŒÎ»Î· 2Î¿Ï… Î±Ï„ÏŒÎ¼Î¿Ï…">
            <button class="search-btn" onclick="geo('city2','lat2','lon2','elev2')" title="Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·">ğŸ”</button>
          </div>
        </div>
        <div style="display:flex; gap:10px; font-size:12px;">
          <div style="flex:1;"><label>Lat</label><input type="text" id="lat2" title="Î Î»Î¬Ï„Î¿Ï‚ 2"></div>
          <div style="flex:1;"><label>Lon</label><input type="text" id="lon2" title="ÎœÎ®ÎºÎ¿Ï‚ 2"></div>
        </div>
      </div>

      <div class="form-group" style="margin-top:20px;">
        <label>Î£ÏÏƒÏ„Î·Î¼Î± ÎŸÎ¯ÎºÏ‰Î½</label>
        <select id="hsys" title="Î•Ï€Î¹Î»Î¿Î³Î® ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ Î¿Î¯ÎºÏ‰Î½">
          <option value="equal">Equal House (ÎŠÏƒÎ¿Î¹)</option>
          <option value="porphyry">Porphyry</option>
        </select>
      </div>

      <div class="btn-row">
        <button class="primary" onclick="calculate()">Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚</button>
        <button onclick="demo()">Demo</button>
      </div>
      <button style="margin-top:12px; width:100%; border-color:var(--accent); color:var(--accent);"
        onclick="toggleModal(true)">ÎŸÎ´Î·Î³Î¯ÎµÏ‚ Î§ÏÎ®ÏƒÎ·Ï‚</button>
    </aside>

    <section class="glass-card" style="flex:1;">
      <div class="tabs-container">
        <div class="tab active" data-sec="tab-planets">Î Î»Î±Î½Î®Ï„ÎµÏ‚</div>
        <div class="tab" data-sec="tab-houses">ÎŸÎ¯ÎºÎ¿Î¹</div>
        <div class="tab" data-sec="tab-wheel">Î§Î¬ÏÏ„Î·Ï‚ (SVG)</div>
        <div class="tab" data-sec="tab-aspects">ÎŒÏˆÎµÎ¹Ï‚</div>
        <div class="tab" data-sec="tab-reports">Î‘Î½Î±Î»Ï…Ï„Î¹ÎºÎ® Î‘Î½Î±Ï†Î¿ÏÎ¬</div>
        <div class="tab" data-sec="tab-forecast">ÎœÎ·Î½Î¹Î±Î¯Î± Î ÏÏŒÎ²Î»ÎµÏˆÎ·</div>
      </div>

      <div id="status" style="margin-bottom:20px; font-weight:700; color:var(--accent); min-height:24px;"></div>

      <div id="tab-planets" class="section active">
        <div id="out-planets"></div>
      </div>

      <div id="tab-houses" class="section">
        <div id="out-houses"></div>
      </div>

      <div id="tab-wheel" class="section" style="text-align:center;">
        <svg id="astroWheel" viewBox="0 0 500 500" style="max-width:600px; width:100%; height:auto;"></svg>
      </div>

      <div id="tab-aspects" class="section">
        <div id="out-aspects"></div>
      </div>

      <div id="tab-reports" class="section">
        <button id="pdfBtn" style="margin-bottom:25px; width:auto; padding:12px 30px; display:none;" class="primary"
          onclick="exportPDF()">Î•Î¾Î±Î³Ï‰Î³Î® ÏƒÎµ PDF</button>
        <div id="out-reports" style="line-height:2.0;"></div>
      </div>

      <div id="tab-forecast" class="section">
        <div id="bio-bars" style="margin-bottom:40px;"></div>
        <div id="out-forecast" style="line-height:2.0;"></div>
      </div>
    </section>
  </main>

  <!-- Modal Instructions -->
  <div class="modal-overlay" id="helpModal">
    <div class="modal-content">
      <h2 style="margin-bottom:20px;">ÎŸÎ´Î·Î³Î¯ÎµÏ‚ Î§ÏÎ®ÏƒÎ·Ï‚</h2>
      <ol>
        <li><b>Î•Ï€Î¹Î»Î¿Î³Î® Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚:</b> Î•Ï€Î¹Î»Î­Î¾Ï„Îµ "Î“ÎµÎ½Î­Î¸Î»Î¹Î¿Ï‚" (Î±Ï„Î¿Î¼Î¹ÎºÏŒ) Î® "Î£Ï…Î½Î±ÏƒÏ„ÏÎ¯Î±" (ÏƒÏ‡Î­ÏƒÎ·).</li>
        <li><b>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚:</b> Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î· Î¼Î¿ÏÏ†Î® DD/MM/YYYY (Ï€.Ï‡. 15/05/1990).</li>
        <li><b>Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÎÏÎ±Ï‚:</b> Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î· Î¼Î¿ÏÏ†Î® HH:MM (Ï€.Ï‡. 14:30).</li>
        <li><b>Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±:</b> Î“ÏÎ¬ÏˆÏ„Îµ Ï„Î·Î½ Ï€ÏŒÎ»Î· ÎºÎ±Î¹ Ï€Î±Ï„Î®ÏƒÏ„Îµ ğŸ” Î³Î¹Î± Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ Î¿Î¹ ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½ÎµÏ‚.</li>
        <li><b>Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚:</b> Î Î±Ï„Î®ÏƒÏ„Îµ Ï„Î¿ ÎºÎ¿Ï…Î¼Ï€Î¯ Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ Î±Î½Î¬Î»Ï…ÏƒÎ·.</li>
        <li><b>Î‘Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î±:</b> Î ÎµÏÎ¹Î·Î³Î·Î¸ÎµÎ¯Ï„Îµ ÏƒÏ„Î¹Ï‚ ÎºÎ±ÏÏ„Î­Î»ÎµÏ‚ Î³Î¹Î± Ï‡Î¬ÏÏ„Î·, ÏŒÏˆÎµÎ¹Ï‚ ÎºÎ±Î¹ Î±Î½Î±Ï†Î¿ÏÎ¬.</li>
      </ol>
      <button class="primary modal-close" onclick="toggleModal(false)">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
  </div>

  <script>
    const ZODIAC = ["ÎšÏÎ¹ÏŒÏ‚", "Î¤Î±ÏÏÎ¿Ï‚", "Î”Î¯Î´Ï…Î¼Î¿Î¹", "ÎšÎ±ÏÎºÎ¯Î½Î¿Ï‚", "Î›Î­Ï‰Î½", "Î Î±ÏÎ¸Î­Î½Î¿Ï‚", "Î–Ï…Î³ÏŒÏ‚", "Î£ÎºÎ¿ÏÏ€Î¹ÏŒÏ‚", "Î¤Î¿Î¾ÏŒÏ„Î·Ï‚", "Î‘Î¹Î³ÏŒÎºÎµÏÏ‰Ï‚", "Î¥Î´ÏÎ¿Ï‡ÏŒÎ¿Ï‚", "Î™Ï‡Î¸ÏÎµÏ‚"];
    const ZODIAC_DESC = {
      "ÎšÏÎ¹ÏŒÏ‚": "Î”Ï…Î½Î±Î¼Î¹ÏƒÎ¼ÏŒÏ‚, Ï€ÏÏ‰Ï„Î¿Î²Î¿Ï…Î»Î¯Î±, Î¸Î¬ÏÏÎ¿Ï‚, Ï€Î±ÏÎ¿ÏÎ¼Î·Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±.",
      "Î¤Î±ÏÏÎ¿Ï‚": "Î£Ï„Î±Î¸ÎµÏÏŒÏ„Î·Ï„Î±, Ï€ÏÎ±ÎºÏ„Î¹ÎºÏŒÏ„Î·Ï„Î±, Î±Î¹ÏƒÎ¸Î·ÏƒÎ¹Î±ÏƒÎ¼ÏŒÏ‚, ÎµÏ€Î¹Î¼Î¿Î½Î®.",
      "Î”Î¯Î´Ï…Î¼Î¿Î¹": "Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±, Ï€ÎµÏÎ¹Î­ÏÎ³ÎµÎ¹Î±, Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÏ„Î¹ÎºÏŒÏ„Î·Ï„Î±, ÎµÏ…Ï†Ï…ÎÎ±.",
      "ÎšÎ±ÏÎºÎ¯Î½Î¿Ï‚": "Î•Ï…Î±Î¹ÏƒÎ¸Î·ÏƒÎ¯Î±, Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î±, Î¿Î¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±, ÏƒÏ…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î±.",
      "Î›Î­Ï‰Î½": "Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î±, Î±Ï…Ï„Î¿Ï€ÎµÏ€Î¿Î¯Î¸Î·ÏƒÎ·, Î·Î³ÎµÏ„Î¹ÎºÏŒÏ„Î·Ï„Î±, Î³ÎµÎ½Î½Î±Î¹Î¿Î´Ï‰ÏÎ¯Î±.",
      "Î Î±ÏÎ¸Î­Î½Î¿Ï‚": "Î›ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹Î±, Î±Î½Î¬Î»Ï…ÏƒÎ·, Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ¬, Î¿ÏÎ³Î¬Î½Ï‰ÏƒÎ·.",
      "Î–Ï…Î³ÏŒÏ‚": "Î‘ÏÎ¼Î¿Î½Î¯Î±, ÏƒÏ‡Î­ÏƒÎµÎ¹Ï‚, Î´Î¹ÎºÎ±Î¹Î¿ÏƒÏÎ½Î·, Î´Î¹Ï€Î»Ï‰Î¼Î±Ï„Î¯Î±.",
      "Î£ÎºÎ¿ÏÏ€Î¹ÏŒÏ‚": "Î Î¬Î¸Î¿Ï‚, Î²Î¬Î¸Î¿Ï‚, Î¼ÎµÏ„Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·, Î­Î½Ï„Î±ÏƒÎ·.",
      "Î¤Î¿Î¾ÏŒÏ„Î·Ï‚": "Î ÎµÏÎ¹Ï€Î­Ï„ÎµÎ¹Î±, Ï†Î¹Î»Î¿ÏƒÎ¿Ï†Î¯Î±, Î±Î¹ÏƒÎ¹Î¿Î´Î¿Î¾Î¯Î±, ÎµÎ»ÎµÏ…Î¸ÎµÏÎ¯Î±.",
      "Î‘Î¹Î³ÏŒÎºÎµÏÏ‰Ï‚": "Î¦Î¹Î»Î¿Î´Î¿Î¾Î¯Î±, Ï€ÎµÎ¹Î¸Î±ÏÏ‡Î¯Î±, Î´Î¿Î¼Î®, Ï‰ÏÎ¹Î¼ÏŒÏ„Î·Ï„Î±.",
      "Î¥Î´ÏÎ¿Ï‡ÏŒÎ¿Ï‚": "Î ÏÏ‰Ï„Î¿Ï„Ï…Ï€Î¯Î±, Î±Î½Î¸ÏÏ‰Ï€Î¹ÏƒÎ¼ÏŒÏ‚, Î±Î½ÎµÎ¾Î±ÏÏ„Î·ÏƒÎ¯Î±, ÎµÏ€Î±Î½Î¬ÏƒÏ„Î±ÏƒÎ·.",
      "Î™Ï‡Î¸ÏÎµÏ‚": "Î”Î¹Î±Î¯ÏƒÎ¸Î·ÏƒÎ·, ÏƒÏ…Î¼Ï€ÏŒÎ½Î¹Î±, Ï†Î±Î½Ï„Î±ÏƒÎ¯Î±, Ï€Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±."
    };

    function toggleModal(show) {
      const modal = document.getElementById('helpModal');
      if (show) modal.classList.add('active');
      else modal.classList.remove('active');
    }
    // Close modal on overlay click
    window.addEventListener('click', (e) => {
      const modal = document.getElementById('helpModal');
      if (e.target === modal) toggleModal(false);
    });
    const HOUSE_DESC = [
      "ÎŸ Î•Î±Ï…Ï„ÏŒÏ‚, Î· Ï€ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒÏ„Î·Ï„Î± ÎºÎ±Î¹ Î· ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ® ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·.",
      "Î¥Î»Î¹ÎºÎ¬ Î±Î³Î±Î¸Î¬, Î±Î¾Î¯ÎµÏ‚ ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÎ® Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±.",
      "Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±, Î±Î´Î­ÏÏ†Î¹Î±, Î¼Î¬Î¸Î·ÏƒÎ· ÎºÎ±Î¹ ÎºÎ¿Î½Ï„Î¹Î½Î­Ï‚ Î¼ÎµÏ„Î±ÎºÎ¹Î½Î®ÏƒÎµÎ¹Ï‚.",
      "Î¡Î¯Î¶ÎµÏ‚, Î¿Î¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î±, Ï„Î¿ ÏƒÏ€Î¯Ï„Î¹ ÎºÎ±Î¹ Î· ÏˆÏ…Ï‡Î¿Î»Î¿Î³Î¹ÎºÎ® Î²Î¬ÏƒÎ·.",
      "Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î±, Î­ÏÏ‰Ï„Î±Ï‚, Ï€Î±Î¹Î´Î¹Î¬ ÎºÎ±Î¹ Î´Î¹Î±ÏƒÎºÎ­Î´Î±ÏƒÎ·.",
      "Î•ÏÎ³Î±ÏƒÎ¯Î±, ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½ÏŒÏ„Î·Ï„Î±, Ï…Î³ÎµÎ¯Î± ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÏ†Î¿ÏÎ¬.",
      "Î£Ï…Î½ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚, Î³Î¬Î¼Î¿Ï‚/ÏƒÏ‡Î­ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Ï†Î±Î½ÎµÏÎ¿Î¯ ÎµÏ‡Î¸ÏÎ¿Î¯.",
      "ÎšÎ¿Î¹Î½Î¬ Ï€ÏŒÏÎ¿Î¹, Î¼ÎµÏ„Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·, Î¼Ï…ÏƒÏ„Î®ÏÎ¹Î¿ ÎºÎ±Î¹ Î²Î¬Î¸Î¿Ï‚.",
      "Î¦Î¹Î»Î¿ÏƒÎ¿Ï†Î¯Î±, Î±Î½ÏÏ„ÎµÏÎ· Î³Î½ÏÏƒÎ·, Ï„Î±Î¾Î¯Î´Î¹Î± ÎºÎ±Î¹ Ï€Î¯ÏƒÏ„Î·.",
      "ÎšÎ±ÏÎ¹Î­ÏÎ±, ÎºÎ¿Î¹Î½Ï‰Î½Î¹ÎºÎ® Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· ÎºÎ±Î¹ Î´Î·Î¼ÏŒÏƒÎ¹Î± ÎµÎ¹ÎºÏŒÎ½Î±.",
      "Î¦Î¯Î»Î¿Î¹, ÎºÎ¿Î¹Î½Ï‰Î½Î¹ÎºÎ­Ï‚ Î¿Î¼Î¬Î´ÎµÏ‚, ÏƒÏ„ÏŒÏ‡Î¿Î¹ ÎºÎ±Î¹ ÎµÎ»Ï€Î¯Î´ÎµÏ‚.",
      "Î¥Ï€Î¿ÏƒÏ…Î½ÎµÎ¯Î´Î·Ï„Î¿, Î±Ï€Î¿Î¼ÏŒÎ½Ï‰ÏƒÎ·, Ï€Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± ÎºÎ±Î¹ ÎºÏÏ…Ï†Î¿Î¯ ÎµÏ‡Î¸ÏÎ¿Î¯."
    ];
    const PLANETS_DEFS = [
      { id: "Sun", name: "Î‰Î»Î¹Î¿Ï‚", desc: "Î— Î¿Ï…ÏƒÎ¯Î±, Î· Î¸Î­Î»Î·ÏƒÎ· ÎºÎ±Î¹ Ï„Î¿ Î•Î³Ï." },
      { id: "Moon", name: "Î£ÎµÎ»Î®Î½Î·", desc: "Î£Ï…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î±, Î­Î½ÏƒÏ„Î¹ÎºÏ„Î¿ ÎºÎ±Î¹ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÏŒÏ‚ ÎºÏŒÏƒÎ¼Î¿Ï‚." },
      { id: "Mercury", name: "Î•ÏÎ¼Î®Ï‚", desc: "Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±, ÏƒÎºÎ­ÏˆÎ· ÎºÎ±Î¹ Î»Î¿Î³Î¹ÎºÎ®." },
      { id: "Venus", name: "Î‘Ï†ÏÎ¿Î´Î¯Ï„Î·", desc: "Î‘Î³Î¬Ï€Î·, Î¿Î¼Î¿ÏÏ†Î¹Î¬, Î±Î¾Î¯ÎµÏ‚ ÎºÎ±Î¹ ÏƒÏ‡Î­ÏƒÎµÎ¹Ï‚." },
      { id: "Mars", name: "Î†ÏÎ·Ï‚", desc: "Î”ÏÎ¬ÏƒÎ·, ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±, Ï€Î¬Î¸Î¿Ï‚ ÎºÎ±Î¹ Î´Î¹ÎµÎºÎ´Î¯ÎºÎ·ÏƒÎ·." },
      { id: "Jupiter", name: "Î”Î¯Î±Ï‚", desc: "Î•Ï€Î­ÎºÏ„Î±ÏƒÎ·, Ï„ÏÏ‡Î·, Ï†Î¹Î»Î¿ÏƒÎ¿Ï†Î¯Î± ÎºÎ±Î¹ Î³Î½ÏÏƒÎ·." },
      { id: "Saturn", name: "ÎšÏÏŒÎ½Î¿Ï‚", desc: "Î”Î¿Î¼Î®, ÎµÏ…Î¸ÏÎ½Î·, ÏŒÏÎ¹Î± ÎºÎ±Î¹ Î¼Î±Î¸Î®Î¼Î±Ï„Î±." },
      { id: "Uranus", name: "ÎŸÏ…ÏÎ±Î½ÏŒÏ‚", desc: "Î•Î»ÎµÏ…Î¸ÎµÏÎ¯Î±, Î±Î»Î»Î±Î³Î®, ÎµÏ€Î±Î½Î¬ÏƒÏ„Î±ÏƒÎ· ÎºÎ±Î¹ Ï€ÏÏ‰Ï„Î¿Ï„Ï…Ï€Î¯Î±." },
      { id: "Neptune", name: "Î Î¿ÏƒÎµÎ¹Î´ÏÎ½Î±Ï‚", desc: "ÎŒÎ½ÎµÎ¹ÏÎ±, Î´Î¹Î±Î¯ÏƒÎ¸Î·ÏƒÎ·, Ï€Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±." },
      { id: "Pluto", name: "Î Î»Î¿ÏÏ„Ï‰Î½Î±Ï‚", desc: "ÎœÎµÏ„Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ·, Î´ÏÎ½Î±Î¼Î· ÎºÎ±Î¹ Î±Î½Î±Î³Î­Î½Î½Î·ÏƒÎ·." }
    ];

    const ASPECTS_DEFS = [
      { name: "Î£ÏÎ½Î¿Î´Î¿Ï‚ (0Â°)", ang: 0, orb: 8, icon: "â˜Œ", desc: "ÎˆÎ½Ï‰ÏƒÎ· ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½." },
      { name: "Î•Î¾Î¬Î³Ï‰Î½Î¿ (60Â°)", ang: 60, orb: 6, icon: "âš¹", desc: "Î•Ï…ÎºÎ±Î¹ÏÎ¯ÎµÏ‚ ÎºÎ±Î¹ Î±ÏÎ¼Î¿Î½Î¯Î±." },
      { name: "Î¤ÎµÏ„ÏÎ¬Î³Ï‰Î½Î¿ (90Â°)", ang: 90, orb: 7, icon: "â–¡", desc: "Î Î¯ÎµÏƒÎ· ÎºÎ±Î¹ Ï€ÏÏŒÎºÎ»Î·ÏƒÎ·." },
      { name: "Î¤ÏÎ¯Î³Ï‰Î½Î¿ (120Â°)", ang: 120, orb: 8, icon: "â–³", desc: "Î¡Î¿Î® ÎºÎ±Î¹ Ï†Ï…ÏƒÎ¹ÎºÎ¬ Ï„Î±Î»Î­Î½Ï„Î±." },
      { name: "Î‘Î½Ï„Î¯Î¸ÎµÏƒÎ· (180Â°)", ang: 180, orb: 7, icon: "â˜", desc: "Î ÏŒÎ»Ï‰ÏƒÎ· ÎºÎ±Î¹ Î¹ÏƒÎ¿ÏÏÎ¿Ï€Î¯Î±." }
    ];

    let currentMode = 'natal';

    // TAB SWITCHING Logic
    document.querySelectorAll('.tab').forEach(t => {
      t.addEventListener('click', () => {
        const secId = t.getAttribute('data-sec');
        if (!secId) return;

        if (secId.startsWith('sidebar-')) {
          document.querySelectorAll('aside .tab').forEach(x => x.classList.remove('active'));
          document.querySelectorAll('aside .section').forEach(x => x.classList.remove('active'));
          t.classList.add('active');
          const target = document.getElementById(secId);
          if (target) target.classList.add('active');
        } else {
          document.querySelectorAll('section.glass-card .tab').forEach(x => x.classList.remove('active'));
          document.querySelectorAll('section.glass-card .section').forEach(x => x.classList.remove('active'));
          t.classList.add('active');
          const target = document.getElementById(secId);
          if (target) target.classList.add('active');
        }
      });
    });

    function parseDateTime(d, t) {
      if (!d) return NaN;
      const parts = d.split('/');
      if (parts.length !== 3) return new Date(d); // Fallback
      const iso = `${parts[2]}-${parts[1]}-${parts[0]}T${t || '12:00'}`;
      return new Date(iso);
    }

    async function geo(cityId, latId, lonId, elevId) {
      const city = document.getElementById(cityId).value;
      if (!city) return;
      document.getElementById('status').innerText = "Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÏ…Î½Ï„ÎµÏ„Î±Î³Î¼Î­Î½Ï‰Î½...";
      try {
        const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(city)}&limit=1`);
        const data = await res.json();
        if (data.length > 0) {
          document.getElementById(latId).value = parseFloat(data[0].lat).toFixed(4);
          document.getElementById(lonId).value = parseFloat(data[0].lon).toFixed(4);
          document.getElementById('status').innerText = `Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±: ${data[0].display_name}`;
        }
      } catch (e) { document.getElementById('status').innerText = "Î£Ï†Î¬Î»Î¼Î± Î³ÎµÏ‰ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼Î¿Ï."; }
    }

    function calculate() {
      const out = document.getElementById('status');
      if (typeof Astronomy === 'undefined') {
        out.innerHTML = "<span class='badge bad'>Î£Ï†Î¬Î»Î¼Î±:</span> Î— Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Astronomy Î´ÎµÎ½ Ï†Î¿ÏÏ„ÏÎ¸Î·ÎºÎµ.";
        return;
      }

      try {
        const d1v = document.getElementById('d1').value;
        const t1v = document.getElementById('t1').value;
        const date1 = parseDateTime(d1v, t1v);

        if (isNaN(date1.getTime())) {
          out.innerText = "ÎœÎ· Î­Î³ÎºÏ…ÏÎ· Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±/ÏÏÎ± (DD/MM/YYYY HH:MM).";
          return;
        }

        const lat1 = parseFloat(document.getElementById('lat1').value) || 0;
        const lon1 = parseFloat(document.getElementById('lon1').value) || 0;
        const sys = document.getElementById('hsys').value;

        out.innerHTML = "<span class='badge' style='background:rgba(255,255,255,0.1)'>Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚...</span>";

        const p1 = getPlanetData(date1);
        const h1 = getHouses(date1, lat1, lon1, sys);

        const isSynastry = document.getElementById('sidebar-synastry').classList.contains('active');
        if (!isSynastry) {
          renderNatal(p1, h1);
          renderForecast(date1);
          out.innerText = "ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ: Î“ÎµÎ½Î­Î¸Î»Î¹Î¿Ï‚ Ï‡Î¬ÏÏ„Î·Ï‚.";
        } else {
          const d2v = document.getElementById('d2').value;
          const t2v = document.getElementById('t2').value;
          const date2 = parseDateTime(d2v, t2v);
        }
      } catch (err) {
        console.error(err);
        out.innerHTML = `<span class='badge bad'>Î£Ï†Î¬Î»Î¼Î±:</span> ${err.message}`;
      }
    }

    function norm(a) { let x = a % 360; return x < 0 ? x + 360 : x; }
    function degToSign(d) {
      let a = norm(d);
      let idx = Math.floor(a / 30);
      return { idx, name: ZODIAC[idx], deg: (a % 30).toFixed(2) };
    }

    function getRetro(body, date) {
      if (body === "Sun" || body === "Moon") return false;
      const l1 = Astronomy.EclipticLongitude(Astronomy.Body[body], date);
      const l2 = Astronomy.EclipticLongitude(Astronomy.Body[body], new Date(date.getTime() + 12 * 3600 * 1000));
      let diff = l2 - l1;
      if (diff > 180) diff -= 360; if (diff < -180) diff += 360;
      return diff < 0;
    }

    function getHouses(date, lat, lon, sys) {
      const eps = 23.43929 * Math.PI / 180;
      const astTime = Astronomy.MakeTime(date);
      const sid = Astronomy.SiderealTime(astTime);
      const ramc = norm((sid * 15) + lon);
      const ramcRad = ramc * Math.PI / 180;
      const phiRad = lat * Math.PI / 180;

      let mc = Math.atan2(Math.sin(ramcRad), Math.cos(ramcRad) * Math.cos(eps)) * 180 / Math.PI;
      mc = norm(mc);
      let asc = Math.atan2(Math.cos(ramcRad), -Math.sin(ramcRad) * Math.cos(eps) - Math.tan(phiRad) * Math.sin(eps)) * 180 / Math.PI;
      asc = norm(asc);

      let cusps = [];
      if (sys === 'equal') {
        for (let i = 0; i < 12; i++) cusps.push(norm(asc + i * 30));
      } else {
        let h10 = mc, h1 = asc;
        let d1 = norm(h1 - h10);
        let s1 = d1 / 3, s2 = (360 - d1) / 3;
        cusps = [h1, norm(h1 + s2), norm(h1 + 2 * s2), norm(h10 + 180), norm(h10 + 180 + s1), norm(h10 + 180 + 2 * s1)];
        for (let i = 0; i < 6; i++) cusps.push(norm(cusps[i] + 180));
      }
      return { asc, mc, cusps };
    }

    function getPlanetData(date) {
      return PLANETS_DEFS.map(p => {
        let lon;
        try {
          if (p.id === "Sun") {
            const sun = (typeof Astronomy.SunPosition === 'function')
              ? Astronomy.SunPosition(date)
              : Astronomy.Ecliptic(Astronomy.GeoVector(Astronomy.Body.Sun, date, true));
            lon = sun.elon;
          } else if (p.id === "Moon") {
            lon = Astronomy.Ecliptic(Astronomy.GeoMoon(date)).elon;
          } else {
            lon = Astronomy.Ecliptic(Astronomy.GeoVector(Astronomy.Body[p.id], date, true)).elon;
          }
        } catch (e) {
          console.error("Error for body " + p.id, e);
          lon = 0;
        }
        return { ...p, lon, r: getRetro(p.id, date) };
      });
    }

    function demo() {
      document.getElementById('d1').value = "02/09/1967";
      document.getElementById('t1').value = "05:15";
      document.getElementById('city1').value = "MELBOURNE";
      document.getElementById('lat1').value = "-37.8142";
      document.getElementById('lon1').value = "144.9632";
      calculate();
    }

    function renderNatal(planets, houses) {
      let html = `<table><tr><th>Î Î»Î±Î½Î®Ï„Î·Ï‚</th><th>Î˜Î­ÏƒÎ·</th><th>Î–ÏÎ´Î¹Î¿</th></tr>`;
      planets.forEach(p => {
        const s = degToSign(p.lon);
        html += `<tr><td title="${p.desc}">${p.name}${p.r ? ' <span class="badge bad" title="Î‘Î½Î¬Î´ÏÎ¿Î¼Î¿Ï‚">R</span>' : ''}</td><td>${s.deg}Â°</td><td><span class="badge good" title="${ZODIAC_DESC[s.name]}">${s.name}</span></td></tr>`;
      });
      document.getElementById('out-planets').innerHTML = html + "</table>";

      let hHtml = `<table><tr><th>ÎŸÎ¯ÎºÎ¿Ï‚</th><th>Î‘ÎºÎ¼Î®</th><th>Î–ÏÎ´Î¹Î¿</th></tr>`;
      houses.cusps.forEach((c, i) => {
        const s = degToSign(c);
        hHtml += `<tr><td title="${HOUSE_DESC[i]}">ÎŸÎ¯ÎºÎ¿Ï‚ ${i + 1}</td><td>${s.deg}Â°</td><td><span class="badge good" title="${ZODIAC_DESC[s.name]}">${s.name}</span></td></tr>`;
      });
      document.getElementById('out-houses').innerHTML = hHtml + "</table>";

      const aspects = renderAspects(planets);
      drawWheel(planets, houses);
      renderReports(planets, houses, aspects);

      const d1v = document.getElementById('d1').value;
      if (d1v) renderForecast(new Date(d1v));
    }

    function renderSynastry(p1, p2) {
      let html = `<table><tr><th>Î‘1 - Î‘2</th><th>ÎŒÏˆÎ·</th><th>ÎŸÏÎ¼Ï€Î·</th></tr>`;
      let synAspects = [];
      p1.forEach(a => {
        p2.forEach(b => {
          let dist = Math.abs(norm(a.lon) - norm(b.lon));
          if (dist > 180) dist = 360 - dist;
          ASPECTS_DEFS.forEach(asp => {
            let diff = Math.abs(dist - asp.ang);
            if (diff <= asp.orb) {
              html += `<tr><td><b>${a.name}-${b.name}</b></td><td title="${asp.desc}">${asp.icon} ${asp.name}</td><td>${diff.toFixed(1)}Â°</td></tr>`;
              synAspects.push({ a, b, asp });
            }
          });
        });
      });
      document.getElementById('out-aspects').innerHTML = html + "</table>";
      document.getElementById('status').innerText = "Î£Ï…Î½Î±ÏƒÏ„ÏÎ¯Î± Î¥Ï€Î¿Î»Î¿Î³Î¯ÏƒÏ„Î·ÎºÎµ Î•Ï€Î¹Ï„Ï…Ï‡ÏÏ‚.";
      renderReports(p1, null, synAspects, p2);
    }

    function renderAspects(planets) {
      let html = `<table><tr><th>Î–ÎµÏÎ³Î¿Ï‚</th><th>ÎŒÏˆÎ·</th><th>ÎŸÏÎ¼Ï€Î·</th></tr>`;
      let aspectList = [];
      for (let i = 0; i < planets.length; i++) {
        for (let j = i + 1; j < planets.length; j++) {
          let dist = Math.abs(norm(planets[i].lon) - norm(planets[j].lon));
          if (dist > 180) dist = 360 - dist;
          ASPECTS_DEFS.forEach(asp => {
            let diff = Math.abs(dist - asp.ang);
            if (diff <= asp.orb) {
              const row = `<tr><td>${planets[i].name}-${planets[j].name}</td><td title="${asp.desc}">${asp.icon} ${asp.name}</td><td>${diff.toFixed(1)}Â°</td></tr>`;
              html += row;
              aspectList.push({ p1: planets[i], p2: planets[j], asp });
            }
          });
        }
      }
      document.getElementById('out-aspects').innerHTML = html + "</table>";
      return aspectList;
    }

    function renderReports(planets, houses, aspects, synastryP2 = null) {
      const out = document.getElementById('out-reports');
      const pdfBtn = document.getElementById('pdfBtn');
      let html = "";

      if (synastryP2) {
        html += `<h3 style="color:var(--accent); text-align:center;">Î‘Î½Î±Ï†Î¿ÏÎ¬ Î£Ï…Î¼Î²Î±Ï„ÏŒÏ„Î·Ï„Î±Ï‚ (Î£Ï…Î½Î±ÏƒÏ„ÏÎ¯Î±)</h3>`;
        html += `<p>Î— ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ· Ï„Ï‰Î½ Î´ÏÎ¿ Ï‡Î±ÏÏ„ÏÎ½ Î±Ï€Î¿ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Î¼Î¹Î± Î¼Î¿Î½Î±Î´Î¹ÎºÎ® Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î¼ÎµÏ„Î±Î¾Ï Î´ÏÎ¿ ÏˆÏ…Ï‡Î¹ÎºÏÎ½ ÎºÏŒÏƒÎ¼Ï‰Î½. </p>`;
        html += `<p>Î Î±ÏÎ±Ï„Î·ÏÎ¿ÏÎ¼Îµ Ï€ÏÏ‚ Î¿Î¹ Î±Î½Î¬Î³ÎºÎµÏ‚ Ï„Î¿Ï… ÎµÎ½ÏŒÏ‚ Î±Ï„ÏŒÎ¼Î¿Ï… (Î£ÎµÎ»Î®Î½Î·) ÏƒÏ…Î½Î±Î½Ï„Î¿ÏÎ½ Ï„Î¹Ï‚ Î±Î¾Î¯ÎµÏ‚ Ï„Î¿Ï… Î¬Î»Î»Î¿Ï… (Î‘Ï†ÏÎ¿Î´Î¯Ï„Î·) ÎºÎ±Î¹ Ï€ÏÏ‚ Î· ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± (Î•ÏÎ¼Î®Ï‚) Î³ÎµÏ†Ï…ÏÏÎ½ÎµÎ¹ Ï„Î¹Ï‚ Î´Î¹Î±Ï†Î¿ÏÎ­Ï‚ Ï„Î¿Ï…Ï‚. ÎŸÎ¹ ÏŒÏˆÎµÎ¹Ï‚ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¿Î½ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Ï€Î¯Î½Î±ÎºÎ± Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ Ï„Î± ÏƒÎ·Î¼ÎµÎ¯Î± Î­Î½Ï„Î±ÏƒÎ·Ï‚ ÎºÎ±Î¹ Ï„Î± ÏƒÎ·Î¼ÎµÎ¯Î± Î±ÏÎ¼Î¿Î½Î¯Î±Ï‚ Ï€Î¿Ï… Î¸Î± ÎºÎ±Î¸Î¿ÏÎ¯ÏƒÎ¿Ï…Î½ Ï„Î·Î½ Ï€Î¿ÏÎµÎ¯Î± Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÏƒÏ‡Î­ÏƒÎ·Ï‚.</p>`;
      } else {
        const pMap = {};
        planets.forEach(p => pMap[p.id] = p);
        const sunS = degToSign(pMap.Sun.lon);
        const moonS = degToSign(pMap.Moon.lon);
        const ascS = degToSign(houses.asc);

        html += `<div id="print-area">`;
        html += `<h3 style="color:#000; text-align:center; border-bottom:2px solid #333; padding-bottom:10px;" class="pdf-title">Î¨Ï…Ï‡Î¿ÏƒÏ‰Î¼Î±Ï„Î¹ÎºÏŒ Î ÏÎ¿Ï†Î¯Î» & Î‘Î½Î¬Î»Ï…ÏƒÎ· Î ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒÏ„Î·Ï„Î±Ï‚</h3>`;

        html += `<h4 style="color:#222;">1. ÎŸ Î Ï…ÏÎ®Î½Î±Ï‚ Ï„Î·Ï‚ ÎÏ€Î±ÏÎ¾Î·Ï‚</h4>`;
        html += `<p>Î— Ï„Î±Ï…Ï„ÏŒÏ„Î·Ï„Î¬ ÏƒÎ±Ï‚ Î´Î¿Î¼ÎµÎ¯Ï„Î±Î¹ Ï€Î¬Î½Ï‰ ÏƒÏ„Î·Î½ Ï„ÏÎ¹Ï€Î»Î­Ï„Î± Î‰Î»Î¹Î¿Ï…, Î£ÎµÎ»Î®Î½Î·Ï‚ ÎºÎ±Î¹ Î©ÏÎ¿ÏƒÎºÏŒÏ€Î¿Ï…. ÎœÎµ Ï„Î¿Î½ <b>Î‰Î»Î¹Î¿ ÏƒÏ„Î¿Î½ ${sunS.name}</b>, Î· Î¶Ï‰Ï„Î¹ÎºÎ® ÏƒÎ±Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹Î± Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ ${ZODIAC_DESC[sunS.name].toLowerCase()} Î•Î¯Î½Î±Î¹ Î¿ Ï„ÏÏŒÏ€Î¿Ï‚ Ï€Î¿Ï… Î»Î¬Î¼Ï€ÎµÏ„Îµ ÎºÎ±Î¹ Î¿ ÏƒÎºÎ¿Ï€ÏŒÏ‚ Ï„Î·Ï‚ Î¸Î­Î»Î·ÏƒÎ®Ï‚ ÏƒÎ±Ï‚.</p>`;
        html += `<p>ÎŸ <b>Î©ÏÎ¿ÏƒÎºÏŒÏ€Î¿Ï‚ ÏƒÏ„Î¿Î½ ${ascS.name}</b> Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Ï‰Ï‚ Î· "Î¼Î¬ÏƒÎºÎ±" Î® Ï„Î¿ ÏƒÏÎ¼Î± ÏƒÎ±Ï‚ Ï€ÏÎ¿Ï‚ Ï„Î¿Î½ Î­Î¾Ï‰ ÎºÏŒÏƒÎ¼Î¿, Ï€ÏÎ¿ÏƒÎ´Î¯Î´Î¿Î½Ï„Î±Ï‚ Î¼Î¹Î± Î±Î¯ÏƒÎ¸Î·ÏƒÎ· ${ZODIAC_DESC[ascS.name].toLowerCase()}</p>`;
        html += `<p>Î£Îµ Î­Î½Î± Î²Î±Î¸ÏÏ„ÎµÏÎ¿ ÎµÏ€Î¯Ï€ÎµÎ´Î¿, Î· <b>Î£ÎµÎ»Î®Î½Î· ÏƒÏ„Î¿Î½ ${moonS.name}</b> ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î¹Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ ÏƒÎ±Ï‚ Î±Î½Î¬Î³ÎºÎµÏ‚ ÎºÎ±Î¹ Ï„Î¿Î½ ÏˆÏ…Ï‡Î¹ÏƒÎ¼ÏŒ ÏƒÎ±Ï‚. Î— Î±Î½Î¬Î³ÎºÎ· ÏƒÎ±Ï‚ Î³Î¹Î± Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î± ÎµÎºÏ†ÏÎ¬Î¶ÎµÏ„Î±Î¹ Î¼Î­ÏƒÎ± Î±Ï€ÏŒ ${ZODIAC_DESC[moonS.name].toLowerCase()}</p>`;

        html += `<h4 style="color:#222;">2. Î•Ï€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î±, Î£Ï…Î½Î±Î¯ÏƒÎ¸Î·Î¼Î± & Î£Ï‰Î¼Î±Ï„Î¹ÎºÎ® Î•Î½Î­ÏÎ³ÎµÎ¹Î±</h4>`;
        const mercS = degToSign(pMap.Mercury.lon);
        const venS = degToSign(pMap.Venus.lon);
        const marsS = degToSign(pMap.Mars.lon);
        html += `<p>ÎŸ Ï„ÏÏŒÏ€Î¿Ï‚ Ï€Î¿Ï… ÏƒÎºÎ­Ï†Ï„ÎµÏƒÏ„Îµ ÎºÎ±Î¹ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½ÎµÎ¯Ï„Îµ (<b>Î•ÏÎ¼Î®Ï‚ ÏƒÏ„Î¿Î½ ${mercS.name}</b>) ÎµÎ¯Î½Î±Î¹ ${ZODIAC_DESC[mercS.name].toLowerCase()} Î³ÎµÎ³Î¿Î½ÏŒÏ‚ Ï€Î¿Ï… ÎºÎ±Î¸Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î·Î½ Ï€Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÎ® ÏƒÎ±Ï‚ ÎµÏ…ÎºÎ¹Î½Î·ÏƒÎ¯Î±. </p>`;
        html += `<p>Î£Ï„Î¿Î½ Ï„Î¿Î¼Î­Î± Ï„Ï‰Î½ Î±Î¾Î¹ÏÎ½ ÎºÎ±Î¹ Ï„Î·Ï‚ Î±Î³Î¬Ï€Î·Ï‚, Î· <b>Î‘Ï†ÏÎ¿Î´Î¯Ï„Î· ÏƒÏ„Î¿Î½ ${venS.name}</b> Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î±Î½Î±Î¶Î·Ï„Î¬Ï„Îµ ${ZODIAC_DESC[venS.name].toLowerCase()} Î— Î´ÏÎ¬ÏƒÎ· ÎºÎ±Î¹ Î· Î´Î¹ÎµÎºÎ´Î¯ÎºÎ·ÏƒÎ® ÏƒÎ±Ï‚ (<b>Î†ÏÎ·Ï‚ ÏƒÏ„Î¿Î½ ${marsS.name}</b>) Ï„ÏÎ¿Ï†Î¿Î´Î¿Ï„Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ ${ZODIAC_DESC[marsS.name].toLowerCase()} ÎµÏ€Î·ÏÎµÎ¬Î¶Î¿Î½Ï„Î±Ï‚ Î¬Î¼ÎµÏƒÎ± Ï„Î· ÏƒÏ‰Î¼Î±Ï„Î¹ÎºÎ® ÏƒÎ±Ï‚ Î±Î½Ï„Î¿Ï‡Î®.</p>`;

        html += `<h4 style="color:#222;">3. ÎšÎ¿Î¹Î½Ï‰Î½Î¹ÎºÎ® Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· & ÎœÎ±Î¸Î®Î¼Î±Ï„Î± Î©ÏÎ¹Î¼ÏŒÏ„Î·Ï„Î±Ï‚</h4>`;
        const jupS = degToSign(pMap.Jupiter.lon);
        const satS = degToSign(pMap.Saturn.lon);
        html += `<p>Î— Î±Î¯ÏƒÎ¸Î·ÏƒÎ· Ï„Î·Ï‚ Ï„ÏÏ‡Î·Ï‚ ÎºÎ±Î¹ Ï„Î·Ï‚ ÎµÏ€Î­ÎºÏ„Î±ÏƒÎ·Ï‚ (<b>Î”Î¯Î±Ï‚ ÏƒÏ„Î¿Î½ ${jupS.name}</b>) Î­ÏÏ‡ÎµÏ„Î±Î¹ ÏŒÏ„Î±Î½ Î±Î³ÎºÎ±Î»Î¹Î¬Î¶ÎµÏ„Îµ ${ZODIAC_DESC[jupS.name].toLowerCase()}</p>`;
        html += `<p>Î‘Î½Ï„Î¯Î¸ÎµÏ„Î±, Î¿ <b>ÎšÏÏŒÎ½Î¿Ï‚ ÏƒÏ„Î¿Î½ ${satS.name}</b> Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ ÏŒÏ€Î¿Ï… Î· Î¶Ï‰Î® ÏƒÎ±Ï‚ Î´Î¿ÎºÎ¹Î¼Î¬Î¶ÎµÎ¹. Î•ÎºÎµÎ¯ ÎºÎ±Î»ÎµÎ¯ÏƒÏ„Îµ Î½Î± Î´ÎµÎ¯Î¾ÎµÏ„Îµ Ï€ÎµÎ¹Î¸Î±ÏÏ‡Î¯Î± ÎºÎ±Î¹ Î½Î± Ï‡Ï„Î¯ÏƒÎµÏ„Îµ ÏƒÏ„Î±Î¸ÎµÏÎ­Ï‚ Î²Î¬ÏƒÎµÎ¹Ï‚ Î¼Î­ÏƒÎ± Î±Ï€ÏŒ ${ZODIAC_DESC[satS.name].toLowerCase()}</p>`;

        html += `<h4 style="color:#222;">4. Î¥Ï€ÎµÏÎ²Î±Ï„Î¹ÎºÎ­Ï‚ Î•Ï€Î¹ÏÏÎ¿Î­Ï‚ & Î£Ï…Î»Î»Î¿Î³Î¹ÎºÏŒ Î‘ÏƒÏ…Î½ÎµÎ¯Î´Î·Ï„Î¿</h4>`;
        const uraS = degToSign(pMap.Uranus.lon);
        const nepS = degToSign(pMap.Neptune.lon);
        const pluS = degToSign(pMap.Pluto.lon);
        html += `<p>ÎŸÎ¹ ÎµÎ¾ÏÏ„ÎµÏÎ¿Î¹ Ï€Î»Î±Î½Î®Ï„ÎµÏ‚ ÏƒÏ…Î½Î´Î­Î¿Ï…Î½ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒÏ„Î·Ï„Î¬ ÏƒÎ±Ï‚ Î¼Îµ Ï„Î¹Ï‚ Ï„Î¬ÏƒÎµÎ¹Ï‚ Ï„Î·Ï‚ ÎµÏ€Î¿Ï‡Î®Ï‚ ÏƒÎ±Ï‚. ÎŸ <b>ÎŸÏ…ÏÎ±Î½ÏŒÏ‚ ÏƒÏ„Î¿Î½ ${uraS.name}</b> Ï†Î­ÏÎ½ÎµÎ¹ Î¾Î±Ï†Î½Î¹ÎºÎ­Ï‚ Î±Î»Î»Î±Î³Î­Ï‚ ÎºÎ±Î¹ ÎºÎ±Î¹Î½Î¿Ï„Î¿Î¼Î¯Î±, Î¿ <b>Î Î¿ÏƒÎµÎ¹Î´ÏÎ½Î±Ï‚ ÏƒÏ„Î¿Î½ ${nepS.name}</b> Î±Î³Î³Î¯Î¶ÎµÎ¹ Ï„Î· Î´Î¹Î±Î¯ÏƒÎ¸Î·ÏƒÎ® ÏƒÎ±Ï‚, ÎºÎ±Î¹ Î¿ <b>Î Î»Î¿ÏÏ„Ï‰Î½Î±Ï‚ ÏƒÏ„Î¿Î½ ${pluS.name}</b> Ï‰Î¸ÎµÎ¯ ÏƒÎµ Î²Î±Î¸Î¹Î­Ï‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Î¼ÎµÏ„Î±Î¼Î¿ÏÏ†ÏÏƒÎµÎ¹Ï‚.</p>`;

        html += `<h4 style="color:#222;">5. Î•ÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ¿Î¯ Î”Î¹Î¬Î»Î¿Î³Î¿Î¹ & Î¨Ï…Ï‡Î¿Î»Î¿Î³Î¹ÎºÎ­Ï‚ Î Ï„Ï…Ï‡Î­Ï‚</h4>`;
        if (aspects.length > 0) {
          html += `<p>ÎŸÎ¹ Î±ÏƒÏ„ÏÎ¿Î»Î¿Î³Î¹ÎºÎ­Ï‚ ÏŒÏˆÎµÎ¹Ï‚ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î¬ Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¹ÎºÎ¬ ÏƒÏ‡Î®Î¼Î±Ï„Î±, Î±Î»Î»Î¬ Î­Î½Î±Ï‚ "Î´Î¹Î¬Î»Î¿Î³Î¿Ï‚" Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ Ï€Î»Î±Î½Î·Ï„ÏÎ½ ÏƒÎ±Ï‚. </p>`;
          aspects.forEach(a => {
            let tone = "";
            if (a.asp.ang === 120 || a.asp.ang === 60) tone = "Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¼Î¹Î± Ï†Ï…ÏƒÎ¹ÎºÎ® ÏÎ¿Î® Î²Î¿Î®Î¸ÎµÎ¹Î±Ï‚, ÏŒÏ€Î¿Ï… Î¿ Î­Î½Î±Ï‚ Ï€Î»Î±Î½Î®Ï„Î·Ï‚ ÎµÎ½Î¹ÏƒÏ‡ÏÎµÎ¹ Ï„Î¿Î½ Î¬Î»Î»Î¿Î½.";
            else if (a.asp.ang === 90 || a.asp.ang === 180) tone = "Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¼Î¹Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¹ÎºÎ® Î­Î½Ï„Î±ÏƒÎ· Ï€Î¿Ï… ÏƒÎ±Ï‚ ÏƒÏ€ÏÏÏ‡Î½ÎµÎ¹ ÏƒÎµ Î´ÏÎ¬ÏƒÎ· ÎºÎ±Î¹ Î¾ÎµÏ€Î­ÏÎ±ÏƒÎ¼Î± ÎµÎ¼Ï€Î¿Î´Î¯Ï‰Î½.";
            else tone = "Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¼Î¹Î± Î±Ï€ÏŒÎ»Ï…Ï„Î· Î­Î½Ï‰ÏƒÎ· ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½.";

            html += `<p>Î£Ï„Î· ÏƒÏ‡Î­ÏƒÎ· Ï„Î¿Ï… <b>${a.p1.name} Î¼Îµ Ï„Î¿Î½ ${a.p2.name}</b>, ${tone} Î£Ï…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î±, ${a.asp.desc.replace(".", "")}.</p>`;
          });
        } else {
          html += `<p>ÎŸ Ï‡Î¬ÏÏ„Î·Ï‚ ÏƒÎ±Ï‚ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¯Î¶ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î¼Î¹Î± ÏƒÏ„Î±Î¸ÎµÏÎ®, Î±Î´Î¹Î±Ï„Î¬ÏÎ±ÎºÏ„Î· ÏÎ¿Î® ÎµÎ½ÎµÏÎ³ÎµÎ¹ÏÎ½, Ï‡Ï‰ÏÎ¯Ï‚ Î­Î½Ï„Î¿Î½ÎµÏ‚ ÎµÏƒÏ‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ ÏƒÏ…Î³ÎºÏÎ¿ÏÏƒÎµÎ¹Ï‚.</p>`;
        }

        html += `<p style="margin-top:20px; font-style:italic; border-top:1px solid #333; padding-top:10px; color:#555;">Î— Î±Î½Î¬Î»Ï…ÏƒÎ· Î±Ï…Ï„Î® ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï€Ï…Î¾Î¯Î´Î± Î³Î¹Î± Ï„Î·Î½ Î±Ï…Ï„Î¿Î³Î½Ï‰ÏƒÎ¯Î± ÏƒÎ±Ï‚. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î·Î½ Ï‰Ï‚ Ï€Î·Î³Î® Î­Î¼Ï€Î½ÎµÏ…ÏƒÎ·Ï‚ Î³Î¹Î± Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÎ® ÏƒÎ±Ï‚ ÎµÎ¾Î­Î»Î¹Î¾Î·.</p>`;
        html += `</div>`;
      }
      out.innerHTML = html;
      pdfBtn.style.display = 'block';
    }

    function renderForecast(birthDate) {
      const now = new Date();
      const diffDays = Math.floor((now - birthDate) / (1000 * 60 * 60 * 24));

      // Biorhythms
      const p = Math.sin(2 * Math.PI * diffDays / 23) * 100;
      const e = Math.sin(2 * Math.PI * diffDays / 28) * 100;
      const i = Math.sin(2 * Math.PI * diffDays / 33) * 100;

      const createBar = (label, val, color) => {
        const isPos = val >= 0;
        const width = Math.abs(val) / 2; // half because 0-100 fits in 50%
        return `
                <div style="margin:15px 0;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                        <span>${label}</span>
                        <span style="color:${isPos ? 'var(--good)' : '#ff4d4d'}; font-weight:bold;">${val.toFixed(0)}%</span>
                    </div>
                    <div style="width:100%; background:rgba(255,255,255,0.05); height:12px; border-radius:6px; position:relative; overflow:hidden; border:1px solid rgba(255,255,255,0.1);">
                        <div style="position:absolute; left:50%; top:0; width:1px; height:100%; background:rgba(255,255,255,0.3); z-index:2;"></div>
                        <div style="
                            position:absolute; 
                            left:${isPos ? '50%' : (50 - (Math.abs(val) / 2)) + '%'}; 
                            width:${Math.abs(val) / 2}%; 
                            height:100%; 
                            background:${isPos ? color : '#ff4d4d'}; 
                            transition: width 0.5s ease;
                        "></div>
                    </div>
                </div>
            `;
      };

      let bioHtml = `<h3>Î£Î·Î¼ÎµÏÎ¹Î½Î¿Î¯ Î’Î¹Î¿ÏÏÏ…Î¸Î¼Î¿Î¯</h3><p style="font-size:12px; color:var(--muted);">Î— ÎºÎµÎ½Ï„ÏÎ¹ÎºÎ® Î³ÏÎ±Î¼Î¼Î® Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎµÎ¹ Ï„Î·Î½ Î¹ÏƒÎ¿ÏÏÎ¿Ï€Î¯Î± (0%).</p>`;
      bioHtml += createBar("Î£Ï‰Î¼Î±Ï„Î¹ÎºÏŒÏ‚ (Î•Î½Î­ÏÎ³ÎµÎ¹Î±)", p, "var(--good)");
      bioHtml += createBar("Î£Ï…Î½Î±Î¹ÏƒÎ¸Î·Î¼Î±Ï„Î¹ÎºÏŒÏ‚ (Î¨Ï…Ï‡Î¿Î»Î¿Î³Î¯Î±)", e, "var(--accent)");
      bioHtml += createBar("Î Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÏŒÏ‚ (Î”Î¹Î±ÏÎ³ÎµÎ¹Î±)", i, "var(--warn)");

      document.getElementById('bio-bars').innerHTML = bioHtml;

      let forecast = `<h3>ÎœÎ·Î½Î¹Î±Î¯Î± Î ÏÏŒÎ²Î»ÎµÏˆÎ· (Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚ 2026)</h3>`;
      forecast += `<p>Î£Ï…Î½Î´Ï…Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î¹Ï‚ Î´Î¹ÎµÎ»ÎµÏÏƒÎµÎ¹Ï‚ Ï„Ï‰Î½ Ï€Î»Î±Î½Î·Ï„ÏÎ½ Î¼Îµ Ï„Î¿Ï…Ï‚ Ï€ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÎ¿ÏÏ‚ ÏƒÎ±Ï‚ Î²Î¹Î¿ÏÏÏ…Î¸Î¼Î¿ÏÏ‚, Î· Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚ Î±Ï…Ï„Î® Î´ÎµÎ¯Ï‡Î½ÎµÎ¹:</p>`;

      // Love
      forecast += `<h4>â¤ï¸ ÎˆÏÏ‰Ï„Î±Ï‚ & Î£Ï‡Î­ÏƒÎµÎ¹Ï‚</h4>`;
      if (e > 40) forecast += `<p><b>Î•Ï…Î½Î¿ÏŠÎºÎ® Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚:</b> ÎŸÎ¹ ÏƒÏ…Î½Î±Î¹ÏƒÎ¸Î·Î¼Î±Ï„Î¹ÎºÎ¿Î¯ ÏƒÎ±Ï‚ Î²Î¹Î¿ÏÏÏ…Î¸Î¼Î¿Î¯ ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î±Î½Î¿Î´Î¹ÎºÎ® Ï„ÏÎ¿Ï‡Î¹Î¬. Î— ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼Îµ Ï„Î¿Î½ ÏƒÏÎ½Ï„ÏÎ¿Ï†Î¿ Î® Î½Î­ÎµÏ‚ Î³Î½Ï‰ÏÎ¹Î¼Î¯ÎµÏ‚ ÎµÏ…Î½Î¿Î¿ÏÎ½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î·Î½ Î±Ï…Î¾Î·Î¼Î­Î½Î· ÏƒÎ±Ï‚ ÎµÎ½ÏƒÏ…Î½Î±Î¯ÏƒÎ¸Î·ÏƒÎ·.</p>`;
      else if (e < -40) forecast += `<p><b>Î ÏÎ¿ÏƒÎ¿Ï‡Î®:</b> Î— Ï‡Î±Î¼Î·Î»Î® ÏƒÏ…Î½Î±Î¹ÏƒÎ¸Î·Î¼Î±Ï„Î¹ÎºÎ® Ï†ÏŒÏÏ„Î¹ÏƒÎ· (-${Math.abs(e).toFixed(0)}%) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï†Î­ÏÎµÎ¹ Ï€Î±ÏÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚. ÎœÎ·Î½ Ï€Î±Î¯ÏÎ½ÎµÏ„Îµ Î±Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚ ÎµÎ½ Î¸ÎµÏÎ¼Ï ÎºÎ±Î¹ Î´ÎµÎ¯Î¾Ï„Îµ ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ·.</p>`;
      else forecast += `<p>ÎœÎ¹Î± Ï€ÎµÏÎ¯Î¿Î´Î¿Ï‚ ÏƒÏ„Î±Î¸ÎµÏÏŒÏ„Î·Ï„Î±Ï‚. Î— Î‘Ï†ÏÎ¿Î´Î¯Ï„Î· ÏƒÎ±Ï‚ ÎºÎ±Î»ÎµÎ¯ Î½Î± ÎµÏƒÏ„Î¹Î¬ÏƒÎµÏ„Îµ ÏƒÏ„Î·Î½ Ï€Î¿Î¹ÏŒÏ„Î·Ï„Î± Ï„Î¿Ï… Ï‡ÏÏŒÎ½Î¿Ï… Ï€Î¿Ï… Ï€ÎµÏÎ½Î¬Ï„Îµ Î¼Îµ Î±Î³Î±Ï€Î·Î¼Î­Î½Î± Ï€ÏÏŒÏƒÏ‰Ï€Î±.</p>`;

      // Career
      forecast += `<h4>ğŸ’¼ Î•ÏÎ³Î±ÏƒÎ¯Î± & ÎšÎ±ÏÎ¹Î­ÏÎ±</h4>`;
      if (i > 40) forecast += `<p><b>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¹ÎºÎ® ÎšÎ¿ÏÏÏ†Ï‰ÏƒÎ·:</b> Î— Ï€Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÎ® ÏƒÎ±Ï‚ Î´Î¹Î±ÏÎ³ÎµÎ¹Î± Î²Î¿Î·Î¸Î¬ ÏƒÏ„Î·Î½ ÎµÏ€Î¯Î»Ï…ÏƒÎ· ÏƒÏÎ½Î¸ÎµÏ„Ï‰Î½ Ï€ÏÎ¿Î²Î»Î·Î¼Î¬Ï„Ï‰Î½. Î™Î´Î±Î½Î¹ÎºÎ® ÏƒÏ„Î¹Î³Î¼Î® Î³Î¹Î± ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÏŒ ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒ.</p>`;
      else if (i < -40) forecast += `<p><b>Î Î½ÎµÏ…Î¼Î±Ï„Î¹ÎºÎ® ÎšÎ¿ÏÏÎ±ÏƒÎ·:</b> Î— ÏƒÏ…Î³ÎºÎ­Î½Ï„ÏÏ‰ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î´ÏÏƒÎºÎ¿Î»Î·. Î‘Ï€Î¿Ï†ÏÎ³ÎµÏ„Îµ Î½Î± Ï…Ï€Î¿Î³ÏÎ¬ÏˆÎµÏ„Îµ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Î­Î³Î³ÏÎ±Ï†Î± Î±Î½ Î´ÎµÎ½ Ï„Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Î´Î¹Ï€Î»Î¬.</p>`;
      else forecast += `<p>Î£Ï…Î½ÎµÏ‡Î¯ÏƒÏ„Îµ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î±. ÎŸÎ¹ Ï€Î»Î±Î½Î·Ï„Î¹ÎºÎ­Ï‚ ÏŒÏˆÎµÎ¹Ï‚ ÏƒÏ„Î¿Î½ 10Î¿ Î¿Î¯ÎºÎ¿ Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ ÎµÏ…ÎºÎ±Î¹ÏÎ¯ÎµÏ‚ Î³Î¹Î± Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ ÏƒÏ…Î½Î­Ï€ÎµÎ¹Î±Ï‚.</p>`;

      // Energy
      forecast += `<h4>âš¡ Î•Î½Î­ÏÎ³ÎµÎ¹Î± & Î¥Î³ÎµÎ¯Î±</h4>`;
      if (p > 40) forecast += `<p><b>Î”Ï…Î½Î±Î¼Î¹ÏƒÎ¼ÏŒÏ‚:</b> Î¤Î¿ ÏƒÏÎ¼Î± ÏƒÎ±Ï‚ Î±Î½Ï„Î±Ï€Î¿ÎºÏÎ¯Î½ÎµÏ„Î±Î¹ Ï„Î­Î»ÎµÎ¹Î± ÏƒÏ„Î·Î½ ÎºÎ¿ÏÏÎ±ÏƒÎ·. Î•ÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Ï„Î· Î¶Ï‰Ï„Î¹ÎºÏŒÏ„Î·Ï„Î¬ ÏƒÎ±Ï‚ Î³Î¹Î± ÏƒÏ‰Î¼Î±Ï„Î¹ÎºÎ® Î´ÏÎ¬ÏƒÎ·.</p>`;
      else if (p < -40) forecast += `<p><b>Î§Î±Î¼Î·Î»Î¿Î¯ Î¤ÏŒÎ½Î¿Î¹:</b> Î¤Î¿ ÏƒÏ‰Î¼Î±Ï„Î¹ÎºÏŒ ÏƒÎ±Ï‚ Î±Ï€ÏŒÎ¸ÎµÎ¼Î± ÎµÎ¯Î½Î±Î¹ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î¿. Î— Î¾ÎµÎºÎ¿ÏÏÎ±ÏƒÎ· Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï…Ï„Î­Î»ÎµÎ¹Î±, Î±Î»Î»Î¬ Î±Î½Î¬Î³ÎºÎ· Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®.</p>`;
      else forecast += `<p>Î”Î¹Î±Ï„Î·ÏÎ®ÏƒÏ„Îµ Î¼Î¹Î± ÎºÎ±Î»Î® ÏÎ¿Ï…Ï„Î¯Î½Î± ÏÏ€Î½Î¿Ï… ÎºÎ±Î¹ Î´Î¹Î±Ï„ÏÎ¿Ï†Î®Ï‚. Î— ÎµÎ½Î­ÏÎ³ÎµÎ¹Î¬ ÏƒÎ±Ï‚ Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ ÎµÏ€Î¯Ï€ÎµÎ´Î± ÏƒÏ…Î½Ï„Î®ÏÎ·ÏƒÎ·Ï‚.</p>`;

      document.getElementById('out-forecast').innerHTML = forecast;
    }

    function exportPDF() {
      const element = document.getElementById('out-reports');
      const originalStyle = element.style.cssText;

      // Solid High Contrast for Search Engines and PDFs
      element.style.background = "#ffffff";
      element.style.color = "#000000";
      element.style.padding = "40px";

      const titles = element.querySelectorAll('h3, h4');
      titles.forEach(t => {
        t.style.color = "#000000";
        t.style.borderBottom = "1px solid #ccc";
      });
      const texts = element.querySelectorAll('p, b');
      texts.forEach(t => t.style.color = "#000000");

      const opt = {
        margin: 10,
        filename: 'Astrology-Report-GR.pdf',
        image: { type: 'jpeg', quality: 1.0 },
        html2canvas: { scale: 2, backgroundColor: '#ffffff', useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };

      const out = document.getElementById('status');
      out.innerText = "Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎµÎ³Î³ÏÎ¬Ï†Î¿Ï… Ï…ÏˆÎ·Î»Î®Ï‚ Ï€Î¹ÏƒÏ„ÏŒÏ„Î·Ï„Î±Ï‚...";

      html2pdf().set(opt).from(element).save().then(() => {
        element.style.cssText = originalStyle;
        out.innerText = "Î¤Î¿ PDF ÎºÎ±Ï„Î­Î²Î·ÎºÎµ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚.";
      });
    }

    function drawWheel(planets, houses) {
      const svg = document.getElementById('astroWheel');
      svg.innerHTML = '';
      const cx = 250, cy = 250, r = 230, ir = 180;

      // Background & Signs
      for (let i = 0; i < 12; i++) {
        let ang = i * 30 - 90; // Starting from Top
        let x1 = cx + r * Math.cos(ang * Math.PI / 180);
        let y1 = cy + r * Math.sin(ang * Math.PI / 180);
        let line = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line.setAttribute("x1", cx); line.setAttribute("y1", cy); line.setAttribute("x2", x1); line.setAttribute("y2", y1);
        line.setAttribute("stroke", "rgba(255,255,255,0.1)");
        svg.appendChild(line);
      }

      // Planets
      planets.forEach(p => {
        let ang = (p.lon - houses.asc) * -1 + 180;
        let x = cx + ir * Math.cos(ang * Math.PI / 180);
        let y = cy + ir * Math.sin(ang * Math.PI / 180);
        let c = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        c.setAttribute("cx", x); c.setAttribute("cy", y); c.setAttribute("r", 5); c.setAttribute("fill", "var(--accent)");
        svg.appendChild(c);
        let t = document.createElementNS("http://www.w3.org/2000/svg", "text");
        t.setAttribute("x", x); t.setAttribute("y", y - 8); t.setAttribute("fill", "white"); t.setAttribute("font-size", "10");
        t.setAttribute("text-anchor", "middle"); t.textContent = p.name;
        svg.appendChild(t);
      });
    }

    function fillDemo() {
      document.getElementById('d1').value = "1988-09-19";
      document.getElementById('t1').value = "05:37";
      document.getElementById('lat1').value = "37.98";
      document.getElementById('lon1').value = "23.72";
      if (currentMode === 'synastry') {
        document.getElementById('d2').value = "1990-05-10";
        document.getElementById('t2').value = "14:20";
      }
      calculate();
    }
  </script>
</body>

</html>